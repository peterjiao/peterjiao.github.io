<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Spring的XML配置 · Hexo</title><meta name="description" content="Spring的XML配置 - John Doe"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://yoursite.com/atom.xml" title="Hexo"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://github.com/peterjiao" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">Spring的XML配置</h1><div class="post-info">Sep 2, 2016</div><div class="post-content"><ul>
<li>content<br>{:toc}</li>
</ul>
<blockquote>
<p>Spring的XML配置。</p>
</blockquote>
<h2 id="XML配置文件"><a href="#XML配置文件" class="headerlink" title="XML配置文件"></a>XML配置文件</h2><h3 id="属性注入："><a href="#属性注入：" class="headerlink" title="属性注入："></a>属性注入：</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">""</span> <span class="attr">class</span>=<span class="string">""</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span>&gt;</span><span class="tag">&lt;<span class="name">value</span>&gt;</span>中文<span class="tag">&lt;/<span class="name">value</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"age"</span>&gt;</span><span class="tag">&lt;<span class="name">value</span>&gt;</span>12<span class="tag">&lt;/<span class="name">value</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>需要有和属性名称对应的set方法。 </p>
<p>根据规范，满足”变量名称的前两个字母，要么全部大写，要么全部小写。“</p>
<h3 id="构造函数注入："><a href="#构造函数注入：" class="headerlink" title="构造函数注入："></a>构造函数注入：</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">“”</span> <span class="attr">class</span>=<span class="string">“”</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">type</span>=<span class="string">"java.lang.String"</span> &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>中文<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">type</span>=<span class="string">"int"</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>20<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>需要有个数和类型相符的构造方法，顺序不重要。 </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">""</span> <span class="attr">class</span>=<span class="string">""</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">"0"</span> <span class="attr">type</span>=<span class="string">"java.lang.String"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>中文<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">"1"</span> <span class="attr">type</span>=<span class="string">"int"</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>20<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>通过index属性，标示顺序。 </p>
<p><code>&lt;ref bean=&quot;person&quot;&gt;</code></p>
<p>通过ref标签，指向其他bean的id。 </p>
<h3 id="工厂方法注入："><a href="#工厂方法注入：" class="headerlink" title="工厂方法注入："></a>工厂方法注入：</h3><h4 id="非静态工厂方法："><a href="#非静态工厂方法：" class="headerlink" title="非静态工厂方法："></a>非静态工厂方法：</h4><pre><code>必须向new一个工厂类，通过这个工厂类生成目标类。 
</code></pre><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PersonFactory</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Person <span class="title">createPerson</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">              <span class="keyword">return</span> <span class="keyword">new</span> Person(<span class="string">"onePerson"</span>,<span class="number">20</span>);</span><br><span class="line"></span><br><span class="line">         &#125;</span><br><span class="line"></span><br><span class="line">     &#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"pFactory"</span> <span class="attr">class</span>=<span class="string">""</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"onePerson"</span> <span class="attr">factory-bean</span>=<span class="string">"pFactory"</span> <span class="attr">factory-method</span>=<span class="string">"createPerson"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>factory-bean // factory-method </p>
<h4 id="静态工厂-："><a href="#静态工厂-：" class="headerlink" title="静态工厂 ："></a>静态工厂 ：</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PersonFactory</span></span>&#123;</span><br><span class="line"></span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Person <span class="title">createPerson</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"secPerson"</span> <span class="attr">class</span>=<span class="string">"com.peter.factory.PersonFactory"</span> <span class="attr">factory-method</span>=<span class="string">"getInstance"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>通过class指向对应的工厂类，让后factory-method属性指向获取目标对象的方法。 </p>
<h3 id="注入参数"><a href="#注入参数" class="headerlink" title="注入参数"></a>注入参数</h3><h4 id="字面值"><a href="#字面值" class="headerlink" title="字面值"></a>字面值</h4><p>可用字符串表示的值，这些值可以通过<code>&lt;value&gt;</code>标签进行注入。 </p>
<p>默认情况下，基本数据类型及其封装类型、String等都采用这种方式。 </p>
<p>​    <code>&lt;value&gt;&lt;![CDATA][ 、，“等等 ]&gt;&lt;/value&gt;</code></p>
<p>特殊字符，需要转义，如下表： </p>
<p>也可以使用！【CDATA】[XXX]    这个标记，其中的字符会原样输出，包含空格。 </p>
<h4 id="引用其他Bean"><a href="#引用其他Bean" class="headerlink" title="引用其他Bean"></a>引用其他Bean</h4><p>使用<code>&lt;ref&gt;</code>元素标记来引用其他bean。 和<code>&lt;value&gt;</code>元素并列。 </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPerson</span><span class="params">(Person p)</span></span>&#123;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"person"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">ref</span> <span class="attr">bean</span>=<span class="string">"person"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><code>&lt;ref&gt;</code>元素标记有三个属性。</p>
<p>bean：引用同意容器或父容器的</p>
<p>local：只能引用同一配置文件的</p>
<p>parent：引用父容器的</p>
<p>说明： 子容器和父容器可以声明相同id 的bean(同一容器不可以) ，所以此处出现了3种可选的引用范围。  </p>
<h4 id="内部Bean"><a href="#内部Bean" class="headerlink" title="内部Bean"></a>内部Bean</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"Boss"</span> <span class="attr">class</span>=<span class="string">"com.peter.person.Boss"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"person"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"com.peter.person.Person"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"boss"</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"age"</span> <span class="attr">value</span>=<span class="string">"20"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>和java的匿名类很像，没有名字，不能被其他类引用或调用，只会被使用一次。 </p>
<h4 id="null值"><a href="#null值" class="headerlink" title="null值"></a>null值</h4><p>如下配置，会给目标设置一个”“的字符串。 </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span><span class="tag">&lt;<span class="name">value</span>&gt;</span><span class="tag">&lt;/<span class="name">value</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>如果想给目标类设置空值null， </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span><span class="tag">&lt;<span class="name">null</span>/&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>使用<code>null</code>标记。 </p>
<h4 id="级联属性"><a href="#级联属性" class="headerlink" title="级联属性"></a>级联属性</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"boss"</span> <span class="attr">class</span>=<span class="string">"com.peter.person.boss"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"person.name"</span> <span class="attr">value</span>=<span class="string">"boss"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>会调用Boss.getPerson().setName(“boss”)进行属性的装配操作。 </p>
<p>Boss对象持有Person对象， 在Boss对象的配置文件中设置了person对象的属性。 </p>
<p>对于层级没有限制。 </p>
<h3 id="集合类型属性"><a href="#集合类型属性" class="headerlink" title="集合类型属性"></a>集合类型属性</h3><p>java.util包中的集合类是最常用的数据结构类型，主要包括List、Set、Map、Properties。 </p>
<p>Spring为这些类提供了专门的配置元素标签。 </p>
<h4 id="List、"><a href="#List、" class="headerlink" title="List、[]"></a>List、[]</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> List&lt;String&gt; favorites;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">""</span> <span class="attr">class</span>=<span class="string">""</span> &gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"favorites"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">value</span>&gt;</span>stay<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">value</span>&gt;</span>play<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><code>list</code>里的内容，可以是字面值用<code>value</code>，也可以是对象用<code>ref</code>来进行配置。 </p>
<p>其他如String[]、int[] 等数组类型也同样使用<code>list</code>元素标记进行配置。 </p>
<h4 id="Set"><a href="#Set" class="headerlink" title="Set"></a>Set</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">value</span>&gt;</span><span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>使用<code>set</code>元素标记，和list使用方法区别不大。 </p>
<h4 id="Map"><a href="#Map" class="headerlink" title="Map"></a>Map</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">map</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">entry</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">key</span>&gt;</span><span class="tag">&lt;<span class="name">value</span>&gt;</span><span class="tag">&lt;/<span class="name">value</span>&gt;</span><span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span><span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">entry</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">key</span>&gt;</span><span class="tag">&lt;<span class="name">value</span>&gt;</span><span class="tag">&lt;/<span class="name">value</span>&gt;</span><span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span><span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">map</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>嵌套元素比较多， 顺序 <code>map</code>、<code>entry</code>、<code>key</code>、<code>value</code>，</p>
<p>map是key-value结构，每一个key-value为一个子项，成为<code>entry</code>。</p>
<p>其中<code>value</code>元素标签可以使用<code>ref</code>元素标签替换，当不是字面值的时候 。 </p>
<h4 id="Properties"><a href="#Properties" class="headerlink" title="Properties"></a>Properties</h4><p>properties,可以看成是特殊的map，即，key和value均是字符串的map。 </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">props</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">""</span>&gt;</span><span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">""</span>&gt;</span><span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">props</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>比map简化，注意，没有用到<code>value</code>元素标签。 </p>
<p><code>props</code>、<code>prop</code></p>
<h4 id="集合合并"><a href="#集合合并" class="headerlink" title="集合合并"></a>集合合并</h4><h3 id="简化配置"><a href="#简化配置" class="headerlink" title="简化配置"></a>简化配置</h3><h4 id="字面值属性"><a href="#字面值属性" class="headerlink" title="字面值属性"></a>字面值属性</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">""</span> <span class="attr">value</span>=<span class="string">""</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">type</span>=<span class="string">""</span> <span class="attr">index</span>=<span class="string">""</span> <span class="attr">value</span>=<span class="string">""</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">map</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">""</span> <span class="attr">value</span>=<span class="string">""</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">map</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>把<code>&lt;value&gt;</code>从一个元素标记变成了一个属性。</p>
<h4 id="引用对象属性"><a href="#引用对象属性" class="headerlink" title="引用对象属性"></a>引用对象属性</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>  <span class="attr">name</span>=<span class="string">""</span> <span class="attr">ref</span>=<span class="string">""</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">type</span>=<span class="string">""</span> <span class="attr">index</span>=<span class="string">""</span>  <span class="attr">ref</span>=<span class="string">""</span>    /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">map</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key-ref</span>=<span class="string">""</span> <span class="attr">value-ref</span>=<span class="string">""</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">map</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><code>&lt;ref&gt;</code>元素标记变成属性。</p>
<p>其中<code>&lt;ref&gt;</code> 的简化形式对应<code>&lt;ref bean=&quot;xxx&quot;&gt;</code> 而 local和parent没有。 </p>
<h4 id="使用p命名空间"><a href="#使用p命名空间" class="headerlink" title="使用p命名空间"></a>使用<code>p</code>命名空间</h4><p>为了简化xml配置，使用属性替代子元素的方式。</p>
<p>需首先引入命名空间。？？</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">""</span> <span class="attr">class</span>=<span class="string">""</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"boss"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"person"</span> <span class="attr">ref</span>=<span class="string">"person"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span>  <span class="attr">id</span>=<span class="string">""</span> <span class="attr">class</span>=<span class="string">""</span>  <span class="attr">p:name</span>=<span class="string">"boss"</span>  <span class="attr">p:person-ref</span>=<span class="string">"person"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>将<code>&lt;property&gt;</code>元素标记变为属性。</p>
<p>形如<code>p:Xxx=&quot;Xxx&quot;</code>,前面为属性名，后面为属性值。</p>
<h3 id="自动装配（autowire）"><a href="#自动装配（autowire）" class="headerlink" title="自动装配（autowire）"></a>自动装配（autowire）</h3><p>为<code>&lt;bean&gt;</code> 元素标记提供了一个属性， <code>autowire=&quot;自动装配类型&quot;</code>。</p>
<p>Spring提供了四种装配类型 ：</p>
<table>
<thead>
<tr>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>byName</td>
<td>根据名称进行自动匹配，假设Boss有一个名为person的属性，如果容器中有一个id为person 的bean，Spring会自动将其装配。</td>
</tr>
<tr>
<td>byType</td>
<td>根据类型进行自动装配，假设Boss有一个Person类型的属性， 如果容器中有一个Person类型的Bean，则自动装配。</td>
</tr>
<tr>
<td>constructor</td>
<td>与ByType类似，针对构造函数而言，如果Boss中有一个构造函数，有一个Perosn类型的入参，。。。。</td>
</tr>
<tr>
<td>autodetect</td>
<td>根据Bean的自省机制决定采用byType还是constructor，如果Bean提供了默认的构造函数，则采用ByType，否则采用constructor。</td>
</tr>
</tbody>
</table>
<p><code>&lt;beans&gt;</code>元素标签中的<code>default-autowire</code>属性可以配置全局自动装配。 默认值是<code>no</code>表示不启用。</p>
<h2 id="bean之间的关系"><a href="#bean之间的关系" class="headerlink" title="bean之间的关系"></a><code>bean</code>之间的关系</h2><h3 id="继承"><a href="#继承" class="headerlink" title="继承"></a>继承</h3><p>如果多各类有相同的方法和属性，则我们可以引入一个父类，在父类中定义这些共同的方法和属性，以消除重复代码。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"abstractPerson"</span>  <span class="attr">class</span>=<span class="string">"com.peter.person"</span> </span></span><br><span class="line"><span class="tag">      <span class="attr">p:name</span>=<span class="string">"aperson"</span> </span></span><br><span class="line"><span class="tag">      <span class="attr">p:age</span>=<span class="string">"20"</span>  </span></span><br><span class="line"><span class="tag">      <span class="attr">abstract</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- ---------------------------------------------------- --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"yongMan"</span> </span></span><br><span class="line"><span class="tag">      <span class="attr">p:age</span>=<span class="string">"18"</span> </span></span><br><span class="line"><span class="tag">      <span class="attr">parent</span>=<span class="string">"abstractPerson"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"oldMan"</span> </span></span><br><span class="line"><span class="tag">      <span class="attr">p:age</span>=<span class="string">"70"</span> </span></span><br><span class="line"><span class="tag">      <span class="attr">parent</span>=<span class="string">"abstractPerson"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>父bean的<code>abstract</code>属性，设置为<code>true</code>则Spring不会创建该bean的实例，为<code>false</code>则这个bean也可以用来装配或者get bean。 </p>
<h3 id="依赖"><a href="#依赖" class="headerlink" title="依赖"></a>依赖</h3><p>一方面，通过元素标签<code>&lt;ref&gt;</code>可以给一个bean指向另一个bean，表示依赖关系。 </p>
<p>另一方面，可以通过<code>&lt;bean&gt;</code>元素标记的属性<code>depends-on</code>来指定要在实例化此bean之前，前置要实例化的bean。这种方法，两个bean之间可以没有任何调用关系。 当有多个Bean时，可以通过<code>,</code>,,<code>;</code> 逗号，空格或分号，创建多个依赖。 </p>
<h3 id="引用"><a href="#引用" class="headerlink" title="引用"></a>引用</h3><p>此处的引用，是指 一个bean中要注入另一个bean的id属性的值，而不是要注入该bean对象的实例 。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span>  <span class="attr">id</span>=<span class="string">"employee"</span> <span class="attr">class</span>=<span class="string">"com.peter.person.Employee"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span>  <span class="attr">id</span>=<span class="string">"boss"</span> <span class="attr">class</span>=<span class="string">"com.peter.person.Boss"</span> </span></span><br><span class="line"><span class="tag">      <span class="attr">p:employeeId</span>=<span class="string">"employee"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>此处，只想给Boss对象注入employeeBean的id属性的值。但是知道运行时期才会发现正确与否。</p>
<p>改进：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span>  <span class="attr">id</span>=<span class="string">"employee"</span> <span class="attr">class</span>=<span class="string">"com.peter.person.Employee"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"boss"</span> <span class="attr">class</span>=<span class="string">"com.peter.person.Boss"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"employeeId"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">idref</span> <span class="attr">bean</span>=<span class="string">"employee"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>这种方式呢，spring在启动时就会针对`idref元素标记进行检测，能够及时的反馈该标记元素内容是否正确。 </p>
<p>此处 <code>bean=&quot;employee&quot;</code> 范围如果是同一个xml配置文件中，可以使用<code>local=&quot;employee&quot;</code>,这种方式IDE可以进行错误检查。 </p>
<h2 id="整合多个配置文件"><a href="#整合多个配置文件" class="headerlink" title="整合多个配置文件"></a>整合多个配置文件</h2><p>1.在配置spring配置文件位置的时候，可以指定多个文件。</p>
<p>2.使用元素标记<code>&lt;import&gt;</code>，可以引入别的配置文件。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">import</span>   <span class="attr">resource</span>=<span class="string">"classpath:resource/daoContext.xml"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">import</span>   <span class="attr">resource</span>=<span class="string">"classpath:resource/coreContext.xml"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<p>一个XML配置文件可以通过<code>&lt;import&gt;</code>组合多个外部配置文件，<code>resource</code>属性支持Spring标准的资源路径。 </p>
<h2 id="Bean作用域"><a href="#Bean作用域" class="headerlink" title="Bean作用域"></a>Bean作用域</h2><table>
<thead>
<tr>
<th>类别</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>singleton</td>
<td>整个生命中，仅存在一个实例，单例模式</td>
</tr>
<tr>
<td>prototype</td>
<td>每次从容器中调用Bean时，都返回一个新的实例，相当于执行 <code>new XxxBean()</code>。</td>
</tr>
<tr>
<td>request</td>
<td>每次Http请求都会创建一个新的Bean。</td>
</tr>
<tr>
<td>session</td>
<td>同一个HTTPSession共享一个Bean。</td>
</tr>
<tr>
<td>globalSession</td>
<td>同一个全局Session共享一个Bean。</td>
</tr>
</tbody>
</table>
<p>通过<code>&lt;bean&gt;</code>属性<code>scope=&quot;&lt;作用域&gt;&quot;</code>，进行设置。 </p>
<h3 id="singleton"><a href="#singleton" class="headerlink" title="singleton"></a>singleton</h3><p>​    一般情况下，无状态或者状态不可变的类适合使用单例模式。</p>
<p>​    Spring默认就是singleton模式，且默认会在启动时实例化所有singleton的Bean并缓存于容器中。 可以通过<code>lazy-init=&quot;true&quot;</code>属性进行控制。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span>  <span class="attr">id</span>=<span class="string">""</span> <span class="attr">class</span>=<span class="string">""</span> </span></span><br><span class="line"><span class="tag">      <span class="attr">p:person-ref</span>=<span class="string">""</span> </span></span><br><span class="line"><span class="tag">      <span class="attr">scoper</span>=<span class="string">"singleton"</span>  </span></span><br><span class="line"><span class="tag">      <span class="attr">lazy-init</span>=<span class="string">"true"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="prototype"><a href="#prototype" class="headerlink" title="prototype"></a>prototype</h3><p>​    每次都返回一个新的bean实例。</p>
<h3 id="Web应用环境相关的Bean作用域"><a href="#Web应用环境相关的Bean作用域" class="headerlink" title="Web应用环境相关的Bean作用域"></a>Web应用环境相关的Bean作用域</h3><p>​    如果使用WebApplicationContext 环境，scope还有另外3个选项：request、session、globalSession。</p>
<p>​    在Web容器中进行额外的配置</p>
<h3 id="作用域依赖"><a href="#作用域依赖" class="headerlink" title="作用域依赖"></a>作用域依赖</h3><h2 id="FactoryBean"><a href="#FactoryBean" class="headerlink" title="FactoryBean"></a>FactoryBean</h2><h2 id="基于注解的配置"><a href="#基于注解的配置" class="headerlink" title="基于注解的配置"></a>基于注解的配置</h2><blockquote>
<p>不管是XML还是注解，它们都是表达Bean定义的载体，其实质都是为Spring容器提供Bean定义的信息，表现形式上是将XML定义的东西通过注解描述。 </p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">spring 2.5 中除了提供 @Component 注释外，还定义了几个拥有特殊语义的注释，它们分别是：@Repository、@Service 和 @Controller。</span><br><span class="line">在目前的 Spring 版本中，这 3 个注释和 @Component 是等效的，但是从注释类的命名上，很容易看出这 3 个注释分别和持久层、业务层和控制层（Web 层）相对应。</span><br><span class="line">虽然目前这3 个注释和 @Component 相比没有什么新意，但 Spring 将在以后的版本中为它们添加特殊的功能。</span><br><span class="line">所以，如果 Web 应用程序采用了经典的三层分层结构的话，最好在持久层、业务层和控制层分别采用上述注解对分层中的类进行注释。</span><br><span class="line"></span><br><span class="line">@Service用于标注业务层组件</span><br><span class="line"></span><br><span class="line">@Controller用于标注控制层组件（如struts中的action）</span><br><span class="line"></span><br><span class="line">@Repository用于标注数据访问组件，即DAO组件</span><br><span class="line"></span><br><span class="line">@Component泛指组件，当组件不好归类的时候，我们可以使用这个注解进行标注。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">1.component-scan标签默认情况下自动扫描指定路径下的包（含所有子包），将带有@Component、@Repository、@Service、@Controller标签的类自动注册到spring容器。对标记了 Spring&apos;s @Required、@Autowired、JSR250&apos;s @PostConstruct、@PreDestroy、@Resource、JAX-WS&apos;s @WebServiceRef、EJB3&apos;s @EJB、JPA&apos;s @PersistenceContext、@PersistenceUnit等注解的类进行对应的操作使注解生效（包含了annotation-config标签的作用）。</span><br><span class="line"></span><br><span class="line">getBean的默认名称是类名（头字母小写），如果想自定义，可以@Service(“aaaaa”)这样来指定。</span><br><span class="line">这种bean默认是“singleton”的，如果想改变，可以使用@Scope(“prototype”)来改变。</span><br></pre></td></tr></table></figure>
<h3 id="使用注解配置信息的前置"><a href="#使用注解配置信息的前置" class="headerlink" title="使用注解配置信息的前置"></a>使用注解配置信息的前置</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">""</span> </span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">""</span> 		<span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span>  </span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:chemaLocation</span>=<span class="string">"http://www.springframework.org/schema/context                    http://www.springframework.org/schema/context/spring-context-3.0.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.peter.person"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>xml的声明处，声明context命名空间。</p>
<p>然后，使用context命名空间的<code>component-scan</code>元素标签,制定扫描该包下的所有类，并从类的注解中获取Bean的定义信息。 </p>
<h3 id="Bean的注解"><a href="#Bean的注解" class="headerlink" title="Bean的注解"></a>Bean的注解</h3><p>作用：取代在Xml配置文件中，使用的<code>&lt;Bean&gt;</code>元素标记。在类的上一行进行注解可达到同样的效果。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Boss</span></span>&#123;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>等价于：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"boss"</span> <span class="attr">class</span>=<span class="string">"com.peter.person.Boss"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="Component"><a href="#Component" class="headerlink" title="@Component"></a>@Component</h4><blockquote>
<p>一个泛华概念，指一个Bean(组件)，可用作任何层次。</p>
</blockquote>
<h4 id="Repository"><a href="#Repository" class="headerlink" title="@Repository"></a>@Repository</h4><blockquote>
<p>标注DAO类，</p>
</blockquote>
<p>不止描述这个类是一个Bean，同时还能降所标注的类中抛出的数据访问异常封装为Spring的数据访问异常类型。 </p>
<h4 id="Service"><a href="#Service" class="headerlink" title="@Service"></a>@Service</h4><blockquote>
<p>通常用在业务层，目前和<code>@Component</code>相同</p>
</blockquote>
<h4 id="Constroller"><a href="#Constroller" class="headerlink" title="@Constroller"></a>@Constroller</h4><blockquote>
<p>通常用在控制层，目前和<code>@Component</code>相同</p>
</blockquote>
<h3 id="自动装配Bean"><a href="#自动装配Bean" class="headerlink" title="自动装配Bean"></a>自动装配Bean</h3><h4 id="Autowired"><a href="#Autowired" class="headerlink" title="@Autowired"></a>@Autowired</h4><p>使用<code>@Autowired</code>进行自动注入</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginService</span></span>&#123;</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> UserDao userDao;</span><br><span class="line"></span><br><span class="line">  	<span class="meta">@Autowired</span></span><br><span class="line">  	<span class="keyword">private</span> LogDao logDao;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>使用<code>@service</code>标记LoginService为一个Bean，通过<code>@Autowired</code>自动注入属性，默认按类型匹配的方式，在容器查找匹配的Bean，当有仅有一个匹配的Bean时，Spring将其注入到@Autowired标注的变量中。 </p>
<h4 id="Autowired属性required"><a href="#Autowired属性required" class="headerlink" title="@Autowired属性required"></a>@Autowired属性required</h4><p>作用：当Spring找不到和标注变量类型相同的Bean时，抛出异常<code>NoSuchBeanDefinitionException</code>，如果希望Spring即使找不到匹配的Bean也不要抛出异常可以使用 <code>@Autowired(required=false)</code>进行标注。 </p>
<h4 id="Qualifier-标注"><a href="#Qualifier-标注" class="headerlink" title="@Qualifier 标注"></a>@Qualifier 标注</h4><p>作用：指定要注入的bean的名称(bean的id)。 </p>
<p>当有多个同类型的bean时，不能使用<code>@Autowired</code>进行标注。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginDao</span></span>&#123;</span><br><span class="line">  <span class="meta">@Autowired</span></span><br><span class="line">  <span class="keyword">private</span> LogDao logDao;</span><br><span class="line">  </span><br><span class="line">  <span class="meta">@Autowired</span></span><br><span class="line">  <span class="meta">@Qualifier</span>(<span class="string">"userDao"</span>)</span><br><span class="line">  <span class="keyword">private</span> UserDao userDao;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>假设容器中有连个类型为<code>UserDao</code>的Bean，一个名为<code>userDao</code>,另一个名为<code>otherUserDao</code>，此处会注入匹配的。 </p>
<h4 id="对类方法进行标注"><a href="#对类方法进行标注" class="headerlink" title="对类方法进行标注"></a>对类方法进行标注</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginService</span></span>&#123;</span><br><span class="line">  <span class="keyword">private</span> LogDao logDao;</span><br><span class="line">  <span class="keyword">private</span> UserDao userDao;</span><br><span class="line">  </span><br><span class="line">  <span class="meta">@Autowired</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLogDao</span><span class="params">(LogDao logDao)</span></span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.logDao=logDao;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="meta">@Autowired</span></span><br><span class="line">  <span class="meta">@Qualifier</span>(<span class="string">"userDao"</span>)</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUserDao</span><span class="params">(UserDao userDao)</span></span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.userDao = userDao;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="meta">@Autowired</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(@Qualifier(<span class="string">"userDao"</span>)</span>UserDao userDao,LogDao logDao)</span>&#123;</span><br><span class="line">    ...</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>将注解标在方法上，同样适用。</p>
<p>且注解在入参上也同样适用。 </p>
<p>​    一般情况下，在Spring容器中大部分的Bean都是单例的，所以一般无需通过<code>@Repository</code>,<code>@Service</code>的属性<code>value</code>为Bean指定名称，也无需<code>@Qualifier</code>指定按名称进行注入。</p>
<h3 id="对集合类型进行标注"><a href="#对集合类型进行标注" class="headerlink" title="对集合类型进行标注"></a>对集合类型进行标注</h3><p>？</p>
<p>@Resource和@Inject</p>
<p>@Resource要求提供一个Bean名称的属性，如果属性为空，则自动采用标注处的变量名或方法名作为目标。 </p>
<p>即：@Autowired默认按类型匹配注入Bean，@Resource则按名称匹配注入Bean。</p>
<p>@Inject和@Autowired一样也是按照类型匹配注入Bean，但是没有required属性。</p>
<h3 id="Bean作用范围及生命过程方法"><a href="#Bean作用范围及生命过程方法" class="headerlink" title="Bean作用范围及生命过程方法"></a>Bean作用范围及生命过程方法</h3><p>作用范围：</p>
<p><code>@Scopre(&quot;prototype&quot;)</code></p>
<p>​    通过注解配置的Bean和通过<bean>标记配置的Bean一样，默认的作用范围都是singleton。</bean></p>
<p>​    注解可以通过@Scope，指定作用范围。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Scopre</span>(<span class="string">"prototype"</span>)</span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span></span>&#123;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>生命周期方法： </p>
<p>​    在配置文件中，可以通过<code>init-method</code>,<code>destroy-method</code>指定Bean的初始化及容器销毁前执行的方法。 </p>
<p>​    注解中，可以使用<code>@PostConstruct</code>,<code>PreDestroy</code>注解，相当于前面的功能，且在同一个Bean中，可定义多个。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Boss</span></span>&#123;</span><br><span class="line">  <span class="keyword">private</span> Person person;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">Boss</span><span class="params">()</span></span>&#123;</span><br><span class="line">    syso();</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="meta">@Autowired</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">setPerson</span><span class="params">(Person person)</span></span>&#123;...&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="meta">@PostConstruct</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">void</span> init1&#123;</span><br><span class="line">    syso(<span class="string">"init 1"</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="meta">@PostConstruct</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">void</span> init2&#123;</span><br><span class="line">    syso(<span class="string">"init 2"</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="meta">@PreDestroy</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">void</span> destroy1&#123;</span><br><span class="line">    syso(<span class="string">"destroy 1"</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="meta">@PreDestroy</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">void</span> destroy2&#123;</span><br><span class="line">    syso(<span class="string">"destroy 2"</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="基于Java类的配置"><a href="#基于Java类的配置" class="headerlink" title="基于Java类的配置"></a>基于Java类的配置</h2><blockquote>
<p>Spring3.0新添加。</p>
</blockquote>
</div></article></div></main><footer><div class="paginator"><a href="/2016/10/15/2016-10-15-缓存-redis/" class="prev">prev_post</a><a href="/2016/09/02/2016-09-02-Spring--Bean的生命周期/" class="next">next_post</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'peterjiao';
var disqus_identifier = '2016/09/02/2016-09-02-Spring-XML配置/';
var disqus_title = 'Spring的XML配置';
var disqus_url = 'http://yoursite.com/2016/09/02/2016-09-02-Spring-XML配置/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//peterjiao.disqus.com/count.js" async></script><div class="copyright"><p>© 2014 - 2018 <a href="http://yoursite.com">John Doe</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>